{% extends 'base.html' %}

{% block title %}لوحة المدير{% endblock %}

{% block content %}
<div class="dashboard-container">
    <h2>مرحبًا {{ session['username'] }} (مدير)</h2>
    <a href="{{ url_for('logout') }}" class="logout-btn">تسجيل خروج</a>

    <!-- إحصائيات سريعة -->
    <section class="stats">
        <div class="stat-card">عدد المصممين: {{ users|selectattr('role','equalto','designer')|list|length }}</div>
        <div class="stat-card">عدد العملاء: {{ users|selectattr('role','equalto','client')|list|length }}</div>
        <div class="stat-card">عدد الطلبات: {{ requests_count }}</div>
    </section>

    <!-- إدارة الحسابات -->
    <h3>المستخدمون</h3>
    <table>
        <tr>
            <th>الاسم</th>
            <th>البريد الإلكتروني</th>
            <th>الدور</th>
            <th>الحالة</th>
            <th>الإجراءات</th>
        </tr>
        {% for user in users %}
        <tr>
            <td>{{ user['username'] }}</td>
            <td>{{ user['email'] }}</td>
            <td>{{ user['role'] }}</td>
            <td>{{ 'مفعل' if user['active'] == 1 else 'معطل' }}</td>
            <td>
                <a href="{{ url_for('toggle_user', user_id=user['id']) }}">
                    {{ 'تعطيل' if user['active'] == 1 else 'تفعيل' }}
                </a>
                |
                <a href="{{ url_for('delete_user', user_id=user['id']) }}" onclick="return confirm('هل أنت متأكد من حذف الحساب؟')">حذف</a>
            </td>
        </tr>
        {% endfor %}
    </table>

    <!-- إدارة المحتوى (مثال: مجالات التصميم) -->
    <h3>إدارة مجالات التصميم</h3>
    <ul>
        <li>شعارات</li>
        <li>منشورات</li>
        <li>بطاقات عمل</li>
        <li>تعديل / حذف مجالات حسب الحاجة</li>
    </ul>

    <!-- متابعة الأداء -->
    <h3>تقارير سريعة</h3>
    <ul>
        <li>عدد الطلبات المفتوحة والمكتملة لكل مصمم</li>
        <li>عدد الطلبات لكل عميل</li>
        <li>متوسط تقييم المصممين (يمكن إضافته لاحقًا)</li>
    </ul>
</div>
{% endblock %}